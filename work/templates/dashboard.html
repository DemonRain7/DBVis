{% load static %}

<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8" />
    <!--这里应该放咱们自己的图标，可以找一个-->
{#    <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">#}
{#    <link rel="icon" type="image/png" href="../assets/img/favicon.ico">#}


    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Work Presentation</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
        name='viewport' />
    <!--     Fonts and icons     -->
    <link href="{% static 'css/fonts_googleapis.css' %}" rel="stylesheet" />
    <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}" />
    <!-- CSS Files -->
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet" />
    <link href="{% static 'css/light-bootstrap-dashboard.css' %}" rel="stylesheet" />
    <!-- CSS Just for demo  -->
    <link href="{% static 'css/demo.css' %}" rel="stylesheet" />
    <!--CSS&js for Demonstrate-->
    <script src="{% static 'js/echarts/echarts/dist/echarts.min.js'%}"></script>
    <script src="{% static 'js/jquery-3.6.0.min.js' %}"></script>
    <script src="{% static 'js/echarts/echarts-wordcloud/dist/echarts-wordcloud.min.js' %}"></script>
    <link rel="stylesheet" href="{% static 'css/charts_demon.css' %}">
    <link rel="stylesheet" href="{% static 'css/music.css' %}">
    <link rel="stylesheet" href="{% static 'css/rank_button.css' %}">
    <script src="{% static 'js/dark.js' %}"></script>
    <script src="{% static 'js/test.js'%}"></script>
    <!--   Core JS Files   -->
    <script src="{% static 'js/core/jquery.3.2.1.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/core/popper.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/core/bootstrap.min.js' %}" type="text/javascript"></script>
    <!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
    <script src="{% static 'js/plugins/bootstrap-switch.js' %}"></script>
    <!--  Google Maps Plugin    -->
    <script type="text/javascript" src="{% static 'js/googleapismap.js' %}"></script>
    <!--  Chartist Plugin  -->
    <script src="{% static 'js/plugins/chartist.min.js' %}"></script>
    <!--  Notifications Plugin    -->
    <script src="{% static 'js/plugins/bootstrap-notify.js' %}"></script>
    <!-- Control Center for Light Bootstrap Dashboard: scripts for the example pages etc -->
    <script src="{% static 'js/light-bootstrap-dashboard.js?v=2.0.0' %}" type="text/javascript"></script>
    <!-- Light Bootstrap Dashboard DEMO methods, don't include it in your project! -->
    <script src="{% static 'js/demo.js' %}"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            // Javascript method's body can be found in assets/js/demos.js
            demo.initDashboardPageCharts();

            demo.showNotification();

        });
    </script>
    <script src="https://kit.fontawesome.com/f881dad7c4.js" crossorigin="anonymous"></script>


    <style>
        @font-face {
            font-family: 'Orbitronio';
            src: url('{% static 'fonts/Orbitronio-1.ttf' %}') format('truetype');
            /* 其他字体属性 */
        }

        p {
            color: #eee;
            text-shadow: 1px 1px 2px #000;
        }

    </style>
    {{ comments|json_script:"comments" }}
    {{ emotions|json_script:"emotions" }}
</head>

<body>
    <div class="wrapper" style="background-color: rgba(0, 0, 0, 0)">
        <div class="sidebar" data-color="white"
            style="background-color: rgba(255,255,255,0.05);border: 1px solid rgba(255, 255, 255, 0.5);">
            <div class="sidebar-wrapper">

                <div class="logo">
                    <a href="/index" class="simple-text" style="font-family: 'Orbitronio';">
                        SCRIPT_VIS&nbsp; </a>
                </div>
                <ul class="nav">
                    <li class="nav-item active">
                        <a class="nav-link" href="/work">
                            <i class="nc-icon nc-chart-pie-35"></i>
                            <p>WORK_PRESENTATION&nbsp;</p>
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="/list">
                            <i class="nc-icon nc-notes"></i>
                            <p>SCRIPT_LIST</p>
                        </a>
                    </li>
                </ul>
                <!--音乐播放器-->

                <div id="music-container" style="top:62rem;">
                    <div id="music-icon"></div>
                    <audio id="music-player">
                        <source src="{% static 'music/Hans Zimmer - Cornfield Chase.flac' %}" type="audio/mpeg">
                    </audio>
                </div>
                <script>
                    const musicIcon = document.getElementById('music-icon');
                    const musicPlayer = document.getElementById('music-player');

                    musicIcon.addEventListener('click', function () {
                        if (musicPlayer.paused) {
                            musicPlayer.play();
                            musicIcon.classList.add('playing');
                        } else {
                            musicPlayer.pause();
                            musicIcon.classList.remove('playing');
                        }
                    });

                </script>


            </div>
        </div>
        <div class="main-panel" style="background-color:rgba(0, 0, 0, 0)">
            <!-- Navbar -->
            <nav class="navbar navbar-expand-lg " color-on-scroll="500"
                style="background-color:rgba(255,255,255,0.05);border: 1px solid rgba(255, 255, 255, 0.5);width: 106%;">
                <div class="container-fluid" style="width: 90%;">
                    <a class="navbar-brand" href="../../work" style="color: #eee;font-family: 'Orbitronio';">
                        SCP_VIS&nbsp; </a>
                    <button href="" class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
                        aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-bar burger-lines" style="color: #eee;"></span>
                        <span class="navbar-toggler-bar burger-lines" style="color: #eee;"></span>
                        <span class="navbar-toggler-bar burger-lines" style="color: #eee;"></span>
                    </button>
                    <div class="collapse navbar-collapse justify-content-end" id="navigation">
                        <ul class="nav navbar-nav mr-auto">
                            <li class="nav-item">
                                <a href="#" class="nav-link" data-toggle="dropdown">
                                    <i class="nc-icon nc-palette"></i>
                                    <span class="d-lg-none" style="color: #eee;">Dashboard</span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="#" class="nav-link">
                                    <i class="nc-icon nc-zoom-split"></i>
                                    <span class="d-lg-block" style="color: #eee;">&nbsp;Search</span>
                                </a>
                            </li>
                        </ul>
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="/index/#about" >
                                    <span class="no-icon " style="color: #eee;">About
                                        us</span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" href="/index">
                                    <span class="no-icon" style="color: #eee;">Home</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <!-- End Navbar -->
            <div class="content">
                <div class="container-fluid">
                    <div class="row">

                        <div class="col-md-3">
                            <!--情感分析-->
                            <div class="card"
                                style="margin-left:-25px;margin-top: -20px; background-color:rgba(0,0,0,0);border: 1px solid rgba(255, 255, 255, 0.5);">
                                <div class="title1"
                                    style="width:100%;height:2rem; display: flex; align-items: center;">
                                    <span
                                        style="display: inline-block; vertical-align: middle;padding-left: 3%;color: #eee;">
                                        情感分析</span>
                                </div>
                            </div>
                            <div class="card"
                                style="margin-left:-25px;margin-top: -30px;background-color: rgba(255, 255, 255, 0.05);border: 1px solid rgba(255, 255, 255, 0.5);">
                                <!--情感分析图1-->
                                <div id="cvb1"
                                    style="display:flex;justify-content:center;align-items:center;width: 90%; height: 25rem;text-align: center;padding-left:10%;margin-top: 20px">
                                    <script>
                                        var chartDom4 = document.getElementById('cvb1');
                                        var myChart4 = echarts.init(chartDom4, 'test');
                                        var option4;
                                        const comment_db = JSON.parse(document.getElementById('comments').textContent);
                                        var expertComments = comment_db.filter(function(comment) {
                                            return comment.comment_type === 'expert';
                                        });
                                        var negativeScores = expertComments.map(function(comment) {
                                            return comment.negative_score;
                                        });

                                        var neutralScores = expertComments.map(function(comment) {
                                            return comment.neutral_score;
                                        });

                                        var positiveScores = expertComments.map(function(comment) {
                                            return comment.positive_score;
                                        });
                                        option4 = {
                                            angleAxis: {
                                                type: 'category',
                                                data: [
                                                    'Paul Greenwood ',
                                                    'James Berardinelli',
                                                    'Nick Pinkerton',
                                                    'PETER TRAVERS',
                                                    'MaryAnn Johanson',
                                                    '4 Star Films',
                                                    'Pvt. Cowboy',
                                                    'Sarthak Brahma',
                                                    'Eric Ambler',
                                                    'Alex Withrow'
                                                ]
                                            },
                                            radiusAxis: {},
                                            polar: {},
                                            series: [
                                                {
                                                    type: 'bar',
                                                    data: negativeScores,
                                                    coordinateSystem: 'polar',
                                                    name: 'Neg',
                                                    stack: 'a',
                                                    emphasis: {
                                                        focus: 'series'
                                                    }
                                                },
                                                {
                                                    type: 'bar',
                                                    data: neutralScores,
                                                    coordinateSystem: 'polar',
                                                    name: 'Neu',
                                                    stack: 'a',
                                                    emphasis: {
                                                        focus: 'series'
                                                    }
                                                },
                                                {
                                                    type: 'bar',
                                                    data: positiveScores,
                                                    coordinateSystem: 'polar',
                                                    name: 'Pos',
                                                    stack: 'a',
                                                    emphasis: {
                                                        focus: 'series'
                                                    }
                                                }
                                            ],
                                            legend: {
                                                show: true,
                                                data: ['Neg', 'Neu', 'Pos']
                                            }
                                        };
                                        option4 && myChart4.setOption(option4);
                                    </script>


                                </div>
                                <!--情感分析图2-->
                                <div class="rank" id="rankonComment"
                                    style="height:26.2rem;width: 100%;margin-top: -20px;"></div>
                                <script>
                                    var chartDom6 = document.getElementById('rankonComment');
                                    var myChart_rank = echarts.init(chartDom6, 'test');
                                    var option_rank;
                                    const emotion_db = JSON.parse(document.getElementById('emotions').textContent);
                                    const expertResultData1 = emotion_db[0].expert_result;
                                    const expertResultData2 = emotion_db[0].user_result;
                                    // prettier-ignore
                                    const regex = /\[(-?\d+\.\d+),\s*(-?\d+)\]/g;
                                    const resultArray1 = [];
                                    let match;
                                    while ((match = regex.exec(expertResultData1)) !== null) {
                                        resultArray1.push([Number(match[1]), Number(match[2])]);
                                    }
                                    const femaleData = resultArray1
                                    console.log(femaleData)
                                    // prettier-ignore
                                    const resultArray2 = [];
                                    while ((match = regex.exec(expertResultData2)) !== null) {
                                        resultArray2.push([Number(match[1]), Number(match[2])]);
                                    }
                                    const maleDeta = resultArray2
                                    {% comment %} maleDeta.push(emotion_db[0].user_result){% endcomment %}
                                    console.log(maleDeta)
                                    function calculateAverage(data, dim) {
                                        let total = 0;
                                        for (var i = 0; i < data.length; i++) {
                                            total += data[i][dim];
                                        }
                                        return (total /= data.length);
                                    }
                                    const scatterOption = (option_rank = {
                                        xAxis: {
                                            scale: true
                                        },
                                        yAxis: {
                                            scale: true,
                                            type: 'time'
                                        },
                                        series: [
                                            {
                                                type: 'scatter',
                                                id: 'comp_critic',
                                                dataGroupId: 'comp_critic',
                                                universalTransition: {
                                                    enabled: true,
                                                    delay: function (idx, count) {
                                                        return Math.random() * 400;
                                                    }
                                                },
                                                data: femaleData
                                            },
                                            {
                                                type: 'scatter',
                                                id: 'comp_user',
                                                dataGroupId: 'comp_user',
                                                universalTransition: {
                                                    enabled: true,
                                                    delay: function (idx, count) {
                                                        return Math.random() * 400;
                                                    }
                                                },
                                                data: maleDeta
                                            }
                                        ]
                                    });
                                    const barOption = {
                                        xAxis: {
                                            type: 'category',
                                            data: ['评论家综合评分', '用户综合评分'],
                                        },
                                        yAxis: {

                                        },
                                        series: [
                                            {
                                                type: 'bar',
                                                id: 'total',
                                                data: [
                                                    {
                                                        value: calculateAverage(femaleData, 0),
                                                        groupId: 'comp_critic'
                                                    },
                                                    {
                                                        value: calculateAverage(maleDeta, 0),
                                                        groupId: 'comp_user'
                                                    }
                                                ],
                                                universalTransition: {
                                                    enabled: true,
                                                    seriesKey: ['comp_critic', 'comp_user'],
                                                    delay: function (idx, count) {
                                                        return Math.random() * 400;
                                                    }
                                                }
                                            }
                                        ]
                                    };
                                    let currentOption = scatterOption;
                                    var changeFlag_rankonComment = true;
                                    setInterval(function () {
                                        if (changeFlag_rankonComment) {
                                            currentOption = currentOption === scatterOption ? barOption : scatterOption;
                                            myChart_rank.setOption(currentOption, true);
                                        }

                                    }, 2000);

                                    option_rank && myChart_rank.setOption(option_rank);

                                </script>
                                <button id="FlagChangeButton"
                                    onclick="changeFlag_rankonComment=!changeFlag_rankonComment; console.log(play/pause) "
                                    style="margin-top: -5px;" style="font-family: 'Orbitronio';">暂停/恢复此处动画 </button>


                            </div>

<!--词云图-->
<div class="card"
style="margin-left:-25px;margin-top: -25px;background-color: rgba(0, 0, 0, 0);border: 1px solid rgba(255, 255, 255, 0.5);">
<div class="title1"
    style="width:100%;height: 2rem; display: flex; align-items: center;">
    <span
        style="display: inline-block; vertical-align: middle;padding-left: 3%;color: #eee;">
        词云</span>
</div>
</div>
<div class="card"
style="margin-left:-25px;margin-top: -25px;background-color:  rgba(255, 255, 255, 0.05);border: 1px solid rgba(255, 255, 255, 0.5);">
<div id="wordclouds"
    style="display:flex;justify-content:center;width:100%;height:30rem;margin-top: 0px;">
</div>
<script>
    // 获取从后端传递的数据
    var highfreqwords = {{ highfreqwords|safe }};

    // 在控制台中输出获取到的数据，以便调试
    console.log("Highfreqwords data:", highfreqwords);

    // 初始化 ECharts 实例
    var myChart3 = echarts.init(document.getElementById('wordclouds'), 'dark');

    // 随机生成颜色的函数
    function getRandomColor() {
        return '#' + Math.floor(Math.random() * 16777215).toString(16);
    }

    // 将从后端获取的数据转换成词云图所需的格式
    var wordCloudData = highfreqwords.map(function (item) {
        return {
            name: item.word,
            value: item.word_freq,
            textStyle: { color: getRandomColor() }
        };
    });

    // 配置项
    var option3 = {
        title: {
            text: '',
            textStyle: {
                fontSize: 32,
                fontWeight: 'bold',
                color: '#333',
            }
        },
        series: [{
            name: '词云',
            type: 'wordCloud',
            shape: 'circle',
            size: ['80%', '80%'],
            rotationRange: [0, 360],
            rotationStep: 45,
            gridSize: 8,
            drawOutOfBound: false,
            data: wordCloudData,
        }],
        textStyle: {
            normal: {
                fontFamily: '微软雅黑',
                fontWeight: 'bold',
                color: function (params) {
                    return 'rgb(' + [
                        Math.round(Math.random() * 255),
                        Math.round(Math.random() * 255),
                        Math.round(Math.random() * 255)
                    ].join(',') + ')';
                }
            },
            emphasis: {
                shadowBlur: 10,
                shadowColor: '#333'
            }
        },
        tooltip: {
            show: true,
            formatter: function (params) {
                return params.name + ': ' + params.value;
            }
        }
    };

    // 渲染图表
    myChart3.setOption(option3);
</script>
</div>
</div>

                        <div class="col-md-6">
                            <!--人物关系-->
                            <div class="card"
                                style="margin-left:-25px;margin-top: -20px;width: 100%; background-color: rgba(0, 0, 0, 0);border: 1px solid rgba(255, 255, 255, 0.5);">
                                <div class="title2"
                                    style="width:100%;height: 2rem; display: flex; align-items: center;">
                                    <span
                                        style="display: inline-block; vertical-align: middle;padding-left: 3%;color: #eee;">
                                        剧本人物关系
                                    </span>
                                     <nav>
                                        <li><a href="/index#feedback">Feedback</a></li>
                                         <script>
                                                 $(document).ready(function () {
                                                    // 打印 success 标志到控制台
                                                    console.log('Feedback submission success:', {% if success %}true{% else %}false{% endif %});
                                                 });
                                         </script>
                                    </nav>
                                    <button id="toggleButton" style=" background-color: transparent;border: 1px solid transparent;color: #0dcaf0;outline: none">切换显示</button>

                                </div>
                            </div>

                            <div class="card"
                                style="margin-left:-25px;margin-top: -30px;width: 100%;background-color:  rgba(255, 255, 255, 0.05);border: 1px solid rgba(255, 255, 255, 0.5);">
                                <div class="box" id="b1"
                                    style="padding-top:2%;width:85%;height:45rem;padding-left: 15%;background-color: rgba(0, 0, 0, 0)">
                                </div>
                                <script>
                                    var characters = {{ characters|safe }};
                                    var chartDom = document.getElementById('b1');
                                    var myChart = echarts.init(chartDom, 'dark');
                                    var option;
                                    myChart.showLoading();

                                    var data = {
                                        nodes: [
                                            {
                                                "id": characters[0].character_id,
                                                "name": characters[0].character_name,
                                                "symbolSize": 8,
                                                "x": 1,
                                                "y": 1,
                                                "value": 8,
                                                "category": 0
                                            },
                                            {
                                                "id": characters[1].character_id,
                                                "name": characters[1].character_name,
                                                "symbolSize": 4,
                                                "x": 1,
                                                "y": 1,
                                                "value": 4,
                                                "category": 0
                                            },
                                            {
                                                "id": characters[2].character_id,
                                                "name": characters[2].character_name,
                                                "symbolSize": 100,
                                                "x": 1,
                                                "y": 1,
                                                "value": 1174,
                                                "category": 7
                                            },
                                            {
                                                "id": characters[3].character_id,
                                                "name": characters[3].character_name,
                                                "symbolSize": 3,
                                                "x": 1,
                                                "y": 1,
                                                "value": 3,
                                                "category": 0
                                            },
                                            {
                                                "id": characters[4].character_id,
                                                "name": characters[4].character_name,
                                                "symbolSize": 30,
                                                "x": 1,
                                                "y": 1,
                                                "value": 72,
                                                "category": 3
                                            },
                                            {
                                                "id": characters[5].character_id,
                                                "name": characters[5].character_name,
                                                "symbolSize": 45,
                                                "x": 1,
                                                "y": 1,
                                                "value": 224,
                                                "category": 4
                                            },
                                            {
                                                "id": characters[6].character_id,
                                                "name": characters[6].character_name,
                                                "symbolSize": 30,
                                                "x": 1,
                                                "y": 1,
                                                "value": 70,
                                                "category": 3
                                            },
                                            {
                                                "id": characters[7].character_id,
                                                "name": characters[7].character_name,
                                                "symbolSize": 7,
                                                "x": 1,
                                                "y": 1,
                                                "value": 7,
                                                "category": 0
                                            },
                                            {
                                                "id": characters[8].character_id,
                                                "name": characters[8].character_name,
                                                "symbolSize": 8,
                                                "x": 1,
                                                "y": 1,
                                                "value": 8,
                                                "category": 0
                                            },
                                            {
                                                "id": characters[9].character_id,
                                                "name": characters[9].character_name,
                                                "symbolSize": 9,
                                                "x": 1,
                                                "y": 1,
                                                "value": 9,
                                                "category": 0
                                            },
                                            {
                                                "id": characters[10].character_id,
                                                "name": characters[10].character_name,
                                                "symbolSize": 13,
                                                "x": -344,
                                                "y": 45,
                                                "value": 13,
                                                "category": 1
                                            },
                                            {
                                                "id": characters[11].character_id,
                                                "name": characters[11].character_name,
                                                "symbolSize": 10,
                                                "x": -87.93029,
                                                "y": -68.8120565,
                                                "value": 10,
                                                "category": 1
                                            },
                                            {
                                                "id": characters[12].character_id,
                                                "name": characters[12].character_name,
                                                "symbolSize": 12,
                                                "x": -3,
                                                "y": -18,
                                                "value": 12,
                                                "category": 1
                                            },
                                            {
                                                "id": characters[13].character_id,
                                                "name": characters[13].character_name,
                                                "symbolSize": 20,
                                                "x": -19,
                                                "y": 178,
                                                "value": 24,
                                                "category": 1
                                            },
                                            {
                                                "id": characters[14].character_id,
                                                "name": characters[14].character_name,
                                                "symbolSize": 15,
                                                "x": -158,
                                                "y": 201,
                                                "value": 15,
                                                "category": 1
                                            },
                                            {
                                                "id": characters[15].character_id,
                                                "name": characters[15].character_name,
                                                "symbolSize": 50,
                                                "x": -127,
                                                "y": 242,
                                                "value": 422,
                                                "category": 5
                                            },
                                            {
                                                "id": characters[16].character_id,
                                                "name": characters[16].character_name,
                                                "symbolSize": 30,
                                                "x": -300,
                                                "y": -39,
                                                "value": 84,
                                                "category": 3
                                            },
                                            {
                                                "id": characters[17].character_id,
                                                "name": characters[17].character_name,
                                                "symbolSize": 35,
                                                "x": -510,
                                                "y": -39,
                                                "value": 199,
                                                "category": 3
                                            },
                                            {
                                                "id": characters[18].character_id,
                                                "name": characters[18].character_name,
                                                "symbolSize": 70,
                                                "x": -46,
                                                "y": -490,
                                                "value": 877,
                                                "category": 6
                                            },
                                            {
                                                "id": characters[19].character_id,
                                                "name": characters[19].character_name,
                                                "symbolSize": 35,
                                                "x": -51.1624,
                                                "y": -56.9891,
                                                "value": 263,
                                                "category": 4
                                            },
                                            {
                                                "id": characters[20].character_id,
                                                "name": characters[20].character_name,
                                                "symbolSize": 45,
                                                "x": 48.12122,
                                                "y": -44.5048,
                                                "value": 395,
                                                "category": 4
                                            },
                                            {
                                                "id": characters[21].character_id,
                                                "name": characters[21].character_name,
                                                "symbolSize": 22,
                                                "x": 356.44113,
                                                "y": -42.13303,
                                                "value": 22,
                                                "category": 1
                                            },
                                            {
                                                "id": characters[22].character_id,
                                                "name": characters[22].character_name,
                                                "symbolSize": 26,
                                                "x": -9.1107,
                                                "y": -32.5133,
                                                "value": 46,
                                                "category": 2
                                            },
                                            {
                                                "id": characters[23].character_id,
                                                "name": characters[23].character_name,
                                                "symbolSize": 24,
                                                "x": -31.42786,
                                                "y": -9.44803,
                                                "value": 24,
                                                "category": 1
                                            },
                                            {
                                                "id": characters[24].character_id,
                                                "name": characters[24].character_name,
                                                "symbolSize": 27.5,
                                                "x": 4.6313396,
                                                "y": -273.8517,
                                                "value": 54,
                                                "category": 2
                                            },
                                            {
                                                "id": characters[25].character_id,
                                                "name": characters[25].character_name,
                                                "symbolSize": 24,
                                                "x": 82.80825,
                                                "y": -20.1144,
                                                "value": 27,
                                                "category": 2
                                            },
                                            {
                                                "id": characters[26].character_id,
                                                "name": characters[26].character_name,
                                                "symbolSize": 24,
                                                "x": 78.64646,
                                                "y": -31.512747,
                                                "value": 27,
                                                "category": 2
                                            },
                                            {
                                                "id": characters[27].character_id,
                                                "name": characters[27].character_name,
                                                "symbolSize": 24,
                                                "x": -81.46074,
                                                "y": -20.20204,
                                                "value": 28,
                                                "category": 2
                                            },
                                            {
                                                "id": characters[28].character_id,
                                                "name": characters[28].character_name,
                                                "symbolSize": 24,
                                                "x": -25.73984,
                                                "y": 82.41631,
                                                "value": 28,
                                                "category": 2
                                            }
                                        ],
                                        links: [
                                            {
                                                "source": "0",
                                                "target": "1"
                                            },
                                            {
                                                "source": "0",
                                                "target": "2"
                                            },
                                            {
                                                "source": "0",
                                                "target": "3"
                                            },
                                            {
                                                "source": "0",
                                                "target": "4"
                                            },
                                            {
                                                "source": "0",
                                                "target": "5"
                                            },
                                            {
                                                "source": "0",
                                                "target": "6"
                                            },
                                            {
                                                "source": "0",
                                                "target": "7"
                                            },
                                            {
                                                "source": "0",
                                                "target": "8"
                                            },
                                            {
                                                "source": "1",
                                                "target": "2"
                                            },
                                            {
                                                "source": "1",
                                                "target": "3"
                                            },
                                            {
                                                "source": "2",
                                                "target": "3"
                                            },
                                            {
                                                "source": "2",
                                                "target": "4"
                                            },
                                            {
                                                "source": "2",
                                                "target": "5"
                                            },
                                            {
                                                "source": "2",
                                                "target": "6"
                                            },
                                            {
                                                "source": "",
                                                "target": ""
                                            },
                                            {
                                                "source": "2",
                                                "target": "7"
                                            },
                                            {
                                                "source": "2",
                                                "target": "8"
                                            },
                                            {
                                                "source": "2",
                                                "target": "9"
                                            },
                                            {
                                                "source": "2",
                                                "target": "10"
                                            },
                                            {
                                                "source": "2",
                                                "target": "11"
                                            },
                                            {
                                                "source": "2",
                                                "target": "12"
                                            },
                                            {
                                                "source": "2",
                                                "target": "13"
                                            },
                                            {
                                                "source": "2",
                                                "target": "14"
                                            },
                                            {
                                                "source": "2",
                                                "target": "15"
                                            },
                                            {
                                                "source": "2",
                                                "target": "16"
                                            },
                                            {
                                                "source": "2",
                                                "target": "17"
                                            },
                                            {
                                                "source": "2",
                                                "target": "18"
                                            },
                                            {
                                                "source": "2",
                                                "target": "19"
                                            },
                                            {
                                                "source": "2",
                                                "target": "20"
                                            },
                                            {
                                                "source": "2",
                                                "target": "21"
                                            },
                                            {
                                                "source": "2",
                                                "target": "22"
                                            },
                                            {
                                                "source": "2",
                                                "target": "23"
                                            },
                                            {
                                                "source": "2",
                                                "target": "24"
                                            },
                                            {
                                                "source": "2",
                                                "target": "25"
                                            },
                                            {
                                                "source": "2",
                                                "target": "26"
                                            },
                                            {
                                                "source": "2",
                                                "target": "27"
                                            },
                                            {
                                                "source": "2",
                                                "target": "28"
                                            },
                                            {
                                                "source": "4",
                                                "target": "5"
                                            },
                                            {
                                                "source": "4",
                                                "target": "6"
                                            },
                                            {
                                                "source": "4",
                                                "target": "7"
                                            },
                                            {
                                                "source": "4",
                                                "target": "8"
                                            },
                                            {
                                                "source": "4",
                                                "target": "9"
                                            },
                                            {
                                                "source": "4",
                                                "target": "10"
                                            },
                                            {
                                                "source": "4",
                                                "target": "11"
                                            },
                                            {
                                                "source": "4",
                                                "target": "12"
                                            },
                                            {
                                                "source": "4",
                                                "target": "13"
                                            },
                                            {
                                                "source": "4",
                                                "target": "14"
                                            },
                                            {
                                                "source": "4",
                                                "target": "15"
                                            },
                                            {
                                                "source": "4",
                                                "target": "16"
                                            },
                                            {
                                                "source": "4",
                                                "target": "17"
                                            },
                                            {
                                                "source": "4",
                                                "target": "18"
                                            },
                                            {
                                                "source": "4",
                                                "target": "19"
                                            },
                                            {
                                                "source": "4",
                                                "target": "20"
                                            },
                                            {
                                                "source": "4",
                                                "target": "21"
                                            },
                                            {
                                                "source": "4",
                                                "target": "22"
                                            },
                                            {
                                                "source": "4",
                                                "target": "23"
                                            },
                                            {
                                                "source": "5",
                                                "target": "6"
                                            },
                                            {
                                                "source": "5",
                                                "target": "7"
                                            },
                                            {
                                                "source": "5",
                                                "target": "8"
                                            },
                                            {
                                                "source": "5",
                                                "target": "9"
                                            },
                                            {
                                                "source": "5",
                                                "target": "10"
                                            },
                                            {
                                                "source": "5",
                                                "target": "11"
                                            },
                                            {
                                                "source": "5",
                                                "target": "12"
                                            },
                                            {
                                                "source": "5",
                                                "target": "13"
                                            },
                                            {
                                                "source": "5",
                                                "target": "14"
                                            },
                                            {
                                                "source": "5",
                                                "target": "15"
                                            },
                                            {
                                                "source": "5",
                                                "target": "16"
                                            },
                                            {
                                                "source": "5",
                                                "target": "17"
                                            },
                                            {
                                                "source": "5",
                                                "target": "18"
                                            },
                                            {
                                                "source": "5",
                                                "target": "19"
                                            },
                                            {
                                                "source": "5",
                                                "target": "20"
                                            },
                                            {
                                                "source": "5",
                                                "target": "21"
                                            },
                                            {
                                                "source": "5",
                                                "target": "22"
                                            },
                                            {
                                                "source": "5",
                                                "target": "23"
                                            },
                                            {
                                                "source": "5",
                                                "target": "24"
                                            },
                                            {
                                                "source": "5",
                                                "target": "25"
                                            },
                                            {
                                                "source": "5",
                                                "target": "26"
                                            },
                                            {
                                                "source": "5",
                                                "target": "27"
                                            },
                                            {
                                                "source": "6",
                                                "target": "7"
                                            },
                                            {
                                                "source": "6",
                                                "target": "8"
                                            },
                                            {
                                                "source": "6",
                                                "target": "9"
                                            },
                                            {
                                                "source": "6",
                                                "target": "10"
                                            },
                                            {
                                                "source": "6",
                                                "target": "11"
                                            },
                                            {
                                                "source": "6",
                                                "target": "12"
                                            },
                                            {
                                                "source": "6",
                                                "target": "13"
                                            },
                                            {
                                                "source": "6",
                                                "target": "14"
                                            },
                                            {
                                                "source": "6",
                                                "target": "15"
                                            },
                                            {
                                                "source": "6",
                                                "target": "16"
                                            },
                                            {
                                                "source": "6",
                                                "target": "17"
                                            },
                                            {
                                                "source": "6",
                                                "target": "18"
                                            },
                                            {
                                                "source": "6",
                                                "target": "19"
                                            },
                                            {
                                                "source": "6",
                                                "target": "20"
                                            },
                                            {
                                                "source": "6",
                                                "target": "21"
                                            },
                                            {
                                                "source": "16",
                                                "target": "17"
                                            },
                                            {
                                                "source": "16",
                                                "target": "18"
                                            },
                                            {
                                                "source": "16",
                                                "target": "19"
                                            },
                                            {
                                                "source": "16",
                                                "target": "20"
                                            },
                                            {
                                                "source": "16",
                                                "target": "21"
                                            },
                                            {
                                                "source": "16",
                                                "target": "22"
                                            },
                                            {
                                                "source": "16",
                                                "target": "23"
                                            },
                                            {
                                                "source": "17",
                                                "target": "18"
                                            },
                                            {
                                                "source": "17",
                                                "target": "19"
                                            },
                                            {
                                                "source": "17",
                                                "target": "20"
                                            },
                                            {
                                                "source": "17",
                                                "target": "21"
                                            },
                                            {
                                                "source": "17",
                                                "target": "22"
                                            },
                                            {
                                                "source": "17",
                                                "target": "23"
                                            },
                                            {
                                                "source": "18",
                                                "target": "19"
                                            },
                                            {
                                                "source": "18",
                                                "target": "20"
                                            },
                                            {
                                                "source": "18",
                                                "target": "21"
                                            },
                                            {
                                                "source": "18",
                                                "target": "22"
                                            },
                                            {
                                                "source": "18",
                                                "target": "23"
                                            }
                                        ],
                                        categories: [
                                            {
                                                "name": "0-9"
                                            },
                                            {
                                                "name": "10-25"
                                            },
                                            {
                                                "name": "26-69"
                                            },
                                            {
                                                "name": "70-199"
                                            },
                                            {
                                                "name": "200-399"
                                            },
                                            {
                                                "name": "400-799"
                                            },
                                            {
                                                "name": "800-999"
                                            },
                                            {
                                                "name": ">999"
                                            }
                                        ]
                                    };

                                    myChart.hideLoading();
                                    data.nodes.forEach(function (node) {
                                        node.label = {
                                            show: node.symbolSize > 30
                                        };
                                    });

                                    option = {
                                        title: {
                                            text: '',
                                            subtext: '',
                                            top: 'bottom',
                                            left: 'right'
                                        },
                                        tooltip: {
                                                formatter: function(params) {
                                                    var node = params.data;
                                                    if (node.id === '2') {
                                                        return '<img src="../static/images/cooper.jpg" style="width: 100px; height: 100px;">'+ ' ' + node.value;
                                                    }
                                                    else if (node.id === '5') {
                                                        return '<img src="../static/images/murph.png" style="width: 100px; height: 100px;">'+ ' ' + node.value;
                                                    }
                                                    else if (node.id === '18') {
                                                        return '<img src="../static/images/brand.png" style="width: 100px; height: 100px;">'+ ' ' + node.value;
                                                    }
                                                    else if (node.id === '17') {
                                                        return '<img src="../static/images/tars.png" style="width: 100px; height: 100px;">'+ ' ' + node.value;
                                                    }
                                                    else if (node.id === '15') {
                                                        return '<img src="../static/images/doyle.png" style="width: 100px; height: 100px;">'+ ' ' + node.value;
                                                    }
                                                    else if (node.id === '19') {
                                                        return '<img src="../static/images/case.png" style="width: 100px; height: 100px;">'+ ' ' + node.value;
                                                    }
                                                    else if (node.id === '20') {
                                                        return '<img src="../static/images/roth.png" style="width: 100px; height: 100px;">'+ ' ' + node.value;
                                                    }
                                                    else if (params.dataType === 'node')
                                                    {
                                                        return node.name + ' ' + node.value;
                                                    }

                                                },
                                            },
                                        legend: [
                                            {
                                                data: data.categories.map(function (a) {
                                                    return a.name;
                                                })
                                            }
                                        ],
                                        animationDurationUpdate: 1500,
                                        animationEasingUpdate: 'quinticInOut',
                                        series: [
                                            {
                                                name: 'Interstellar',
                                                type: 'graph',
                                                layout: 'circular',
                                                circular: {
                                                    rotateLabel: true
                                                },
                                                data: data.nodes,
                                                links: data.links,
                                                categories: data.categories,
                                                roam: true,
                                                label: {
                                                    position: 'right',
                                                    formatter: '{b}'
                                                },
                                                lineStyle: {
                                                    color: 'source',
                                                    curveness: 0.3
                                                },
                                                emphasis: {
                                                    focus: 'adjacency',
                                                    lineStyle: {
                                                        width: 10
                                                    }
                                                },
                                                data: data.nodes.map(function (node) {
                                                    return {
                                                        ...node,
                                                        id: node.id
                                                    };
                                                })
                                            }
                                        ]
                                    };

                                    myChart.setOption(option);
                                </script>

                                <div class="box" id="b1-back"
                                    style="padding-top:2%;width:85%;height:45rem;padding-left: 15%;background-color: rgba(0, 0, 0, 0)">
                                      <div id="relationship-chart">
                                        <i id="fullscreen-icon" class="fas fa-expand"></i>
                                        <div class="tooltip"></div>
                                      </div>
                                      <!--人关系连线-->
                                      <script src="https://d3js.org/d3.v6.min.js"></script>
                                      <script>
                                        let svg;
                                        let simulation;
                                        let tooltip;
                                        var interactions = {{ interactions|safe }};
                                        var characters = {{ characters|safe }};


                                        const chartDiv = document.getElementById("relationship-chart");
                                        chartDiv.style.width = '100%';
                                        chartDiv.style.height = '45rem';
                                        chartDiv.style.position = 'absolute';
                                        chartDiv.style.top = '0px';
                                        chartDiv.style.left = '0px';
                                        let isFullscreen = false;
                                        const toggleFullScreen = () => {
                                          isFullscreen = !isFullscreen;

                                          if (isFullscreen) {

                                            chartDiv.style.width = '85vw';
                                            chartDiv.style.height = '235vh';
                                            chartDiv.style.position = 'absolute';
                                            chartDiv.style.top = '-7rem';
                                            chartDiv.style.left = '-21rem';
                                            chartDiv.style.background = 'rgba(0, 0, 0, 0.3)'
                                            initChartAfterFullScreen();

                                          } else {
                                            chartDiv.style.width = '100%';
                                            chartDiv.style.height = '45rem';
                                            chartDiv.style.position = 'absolute';
                                            chartDiv.style.top = '0px';
                                            chartDiv.style.left = '0px';
                                            chartDiv.style.background = 'rgba(0, 0, 0, 0)'
                                            initChartAfterFullScreen();
                                          }
                                        };

                                        const initChartAfterFullScreen = () => {
                                          if (svg) {
                                            svg.remove();
                                            simulation.stop();
                                          }
                                          setTimeout(() => {
                                            initChart();
                                          }, 500);
                                        };

                                        const initChart = () => {
                                          const width = chartDiv.clientWidth;
                                          const height = chartDiv.clientHeight;
                                          const centerX = width / 2;
                                          const centerY = height / 2;

                                          svg = d3.select("#relationship-chart")
                                            .append("svg")
                                            .attr("width", width)
                                            .attr("height", height);

                                          tooltip = d3.select("#relationship-chart")
                                            .append("div")
                                            .attr("class", "tooltip")
                                            .style("opacity", 0);

                                          const clipPathRadius = Math.min(width, height) / 10;
                                          const linkDistance = Math.min(width, height) /2;
                                          <!--节点和连线数据-->
                                          const nodes = [

                                          ];
                                          const links = [

                                          ];
                                          // 遍历 interactions 表
                                            for (const row of interactions) {
                                              const scriptId = row['script_id'];
                                              // 如果 script_id 等于 0，则将该项添加到 links 数组
                                              if (scriptId === 0) {
                                                const source = row['character_id_one_id'];
                                                const target = row['character_id_two_id'];
                                                const relationship = row['relation'];
                                                let sourceCharacterName = 'NULL';
                                                let targetCharacterName = 'NULL';
                                                for (const row of characters){
                                                   const characters_scriptId = row['script_id'];
                                                   if (characters_scriptId === 0){
                                                       if(characters_scriptId+"_"+row['character_id'] === source){
                                                           sourceCharacterName=row['character_name'];
                                                       }
                                                       if(characters_scriptId+"_"+row['character_id'] === target){
                                                           targetCharacterName=row['character_name'];
                                                       }
                                                   }
                                                }
                                                if (!nodes.some(node => node.id === source)) {
                                                  nodes.push({ id: source, name: sourceCharacterName, image: "{% static 'images/' %}"+ sourceCharacterName+".png"});
                                                }

                                                if (!nodes.some(node => node.id === target)) {
                                                  nodes.push({ id: target, name: targetCharacterName, image: "{% static 'images/' %}"+ targetCharacterName+".png"});
                                                }

                                                links.push({ source, target, relationship });
                                              }
                                            }
                                            console.log("links ",links);
                                            console.log("nodes ",nodes);

                                              simulation = d3.forceSimulation(nodes)
                                                .force("link", d3.forceLink(links).id(d => d.id).distance(linkDistance))
                                                .force("charge", d3.forceManyBody().strength(-350))
                                                .force("center", d3.forceCenter(centerX, centerY));

                                              const link = svg.append("g")
                                                .selectAll(".link")
                                                .data(links)
                                                .enter()
                                                .append("line")
                                                .attr("class", "link")
                                                .attr("marker-end", "url(#arrow)");

                                              const node = svg.append("g")
                                                .selectAll(".node-image")
                                                .data(nodes)
                                                .enter()
                                                .append("image")
                                                .attr("class", "node-image")
                                                .attr("xlink:href", d => d.image)
                                                .attr("width", clipPathRadius)
                                                .attr("height", clipPathRadius)
                                                .style("clip-path", `circle(${clipPathRadius/2}px)`)
                                                .call(d3.drag()
                                                  .on("start", dragstarted)
                                                  .on("drag", dragged)
                                                  .on("end", dragended))
                                                  .on("mouseover", (event, d) => showTooltip(d.name, event.clientX, event.clientY))
                                                  .on("mouseout", hideTooltip);

                                              const text = svg.append("g")
                                                  .selectAll("text")
                                                  .data(links)
                                                  .enter()
                                                  .append("text")
                                                  .text(d => `${d.relationship}`)
                                                  .attr("dy", 0)  // 调整垂直方向的偏移
                                                  .attr("text-anchor", "middle")
                                                  .attr("fill", "#fff")
                                                  .attr("x", d => (d.source.x + d.target.x) / 2)
                                                  .attr("y", d => (d.source.y + d.target.y) / 2);



                                              simulation.on("tick", () => {
                                                link
                                                  .attr("x1", d => d.source.x)
                                                  .attr("y1", d => d.source.y)
                                                  .attr("x2", d => d.target.x)
                                                  .attr("y2", d => d.target.y);

                                                node
                                                  .attr("x", d => d.x - clipPathRadius/2)
                                                  .attr("y", d => d.y - clipPathRadius/2);

                                                text
                                                  .attr("x", d => (d.source.x + d.target.x) / 2)
                                                  .attr("y", d => (d.source.y + d.target.y) / 2);


                                              });
                                            };


                                            function showTooltip(name, x, y) {
                                               const rect = chartDiv.getBoundingClientRect();
                                              tooltip.transition()
                                                .duration(200)
                                                .style("opacity", 0.9);
                                              tooltip.html(name)
                                                .style("left", (x-rect.left ) + "px")
                                                .style("top", (y-rect.top ) + "px");
                                            }

                                            function hideTooltip() {
                                              tooltip.transition()
                                                .duration(200)
                                                .style("opacity", 0);
                                            }

                                            document.getElementById("fullscreen-icon").addEventListener("click", () => {
                                              toggleFullScreen();
                                            });

                                            function dragstarted(event, d) {
                                              if (!event.active) simulation.alphaTarget(0.3).restart();
                                              d.fx = d.x;
                                              d.fy = d.y;
                                            }

                                            function dragged(event, d) {
                                              d.fx = event.x;
                                              d.fy = event.y;
                                            }

                                            function dragended(event, d) {
                                              if (!event.active) simulation.alphaTarget(0);
                                              d.fx = null;
                                              d.fy = null;
                                            }

                                            initChart();


                                      </script>
                                </div>
                                <style>
                                    #relationship-chart {


                                      overflow: hidden;
                                      transition: all 0.5s;
                                      z-index: 1;

                                    }

                                    .fullscreen #relationship-chart {
                                      width: 100vw;
                                      height: 100vh;
                                      z-index: 1;

                                    }

                                    .link {
                                      fill: none;
                                      stroke: rgb(67,188,212);
                                      stroke-width: 2px;
                                    }

                                    .node-image {
                                      clip-path: circle(20px at center);
                                    }

                                    text {
                                      fill: #fff;
                                    }

                                    #fullscreen-icon {
                                      position: absolute;
                                      bottom: 20px;
                                      right: 20px;
                                      cursor: pointer;
                                      color: #fff;
                                      transition: transform 0.3s;
                                      font-size: 20px; /* 修改为你想要的大小 */;
                                    }

                                    #fullscreen-icon:hover {
                                      transform: scale(1.3);
                                    }

                                    .tooltip {
                                      position: absolute;
                                      background: rgba(0, 0, 0, 0.7);
                                      color: #fff;
                                      padding: 5px;
                                      border-radius: 3px;
                                      pointer-events: none;
                                      opacity: 0;
                                      transition: opacity 0.3s;
                                    }
                                    #b1{
                                        display: block;
                                    }
                                    #b1-back{
                                        display: none;
                                    }
                                </style>
                                <!--关系图-连线图转换-->
                                <script>
                                  document.addEventListener('DOMContentLoaded', function () {
                                    // 获取按钮和两个div的引用
                                    var toggleButton = document.getElementById('toggleButton');
                                    var div1 = document.getElementById('b1');
                                    var div2 = document.getElementById('b1-back');
                                    let istogger = false;
                                    // 给按钮添加点击事件监听器
                                    toggleButton.addEventListener('click', function () {
                                      istogger = !istogger;
                                      if(istogger){
                                        div1.style.display = 'none'
                                        div2.style.display = 'block'
                                      }
                                      else{
                                        div1.style.display = 'block'
                                        div2.style.display = 'none'
                                      }

                                    });
                                  });
                                </script>

                                <!--人物关系与时间轴的交互-->
                                <script>
                                    myChart.on('click', function (params) {
                                        console.log(params.data.id, params.data.name);
                                        let nodeId = params.data.id;
                                        let option = myCharts.getOption();
                                        if (nodeId == 2) {
                                            console.log(nodeId)
                                            option.xAxis[0].axisLabel.formatter = function (value, index) {
                                                console.log(value + ' ' + index)
                                                const item = datas[index];
                                                return item.id === 2 || item.id === 5 || item.id === 8 || item.id === 41 ? value : '';
                                            };
                                            const filterIds = [2, 5, 8, 41];
                                            const axisData = option.xAxis[0].data.map(item => {
                                                if (filterIds.indexOf(item.id) === -1) {
                                                    item.label = '';
                                                } else {
                                                    item.label = item.year;
                                                }
                                                return item;
                                            });
                                            myCharts.setOption({
                                                xAxis: {
                                                    data: axisData
                                                }
                                            });
                                        }
                                    });
                                </script>

                                <!-- 时间线-->
                                <div id="scene"
                                    style="display:flex;justify-content:center;width:100%;height:10rem;margin-top: -20px;">

                                </div>
                                <script>
                                    var myCharts = echarts.init(document.getElementById('scene'));
                                    var datas = [
                                    {% for scene in scenes %}
                                        { year: '{{ scene.scene_id }}', value: 0, id: {{ forloop.counter0}}, itemStyle: { opacity: 1 } },
                                    {% endfor %}

                                    ];
                                    var options = {
                                        xAxis: {
                                            type: 'category',
                                            data: datas.map(item => item.year),
                                            boundaryGap: false,
                                            axisLabel: {
                                                interval: 0,
                                                rotate: 0,
                                            },
                                        },
                                        yAxis: {
                                            type: 'value',
                                            show: false,
                                            max: '0',
                                            min: '0'
                                        },
                                        series: [
                                            {
                                                name: 'Value',
                                                type: 'line',
                                                smooth: true,
                                                symbolSize: 15,
                                                data: datas.map(item => ({ value: item.value, id: item.id, name: item.year })),
                                                value: 0,
                                                itemStyle: {
                                                    normal: {
                                                        color: '#6e7074',
                                                        borderColor: '#fff',
                                                        borderWidth: 1,
                                                        shadowBlur: 10,
                                                        shadowColor: 'rgba(0, 0, 0, 0.3)',
                                                    },
                                                },
                                                emphasis: {
                                                    color: 'red',
                                                    borderWidth: 2,
                                                    shadowBlur: 20,
                                                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                                                }
                                            }
                                        ],
                                        dataZoom: [
                                            {
                                                type: 'slider',
                                                show: true,
                                                startValue: 0,
                                                endValue: 7,
                                                bottom: 10,
                                                height: 10,
                                                minValueSpan: 7,
                                                maxValueSpan: 7,
                                                showDetail: false,
                                                backgroundColor: 'paleturquoise',
                                                borderColor: 'rgba(128, 128, 128, 0.3)',
                                                fillerColor: 'rgba(128, 128, 128, 0.4)',
                                                handleColor: 'rgba(128, 128, 128, 0.7)',
                                                textStyle: {
                                                    color: 'rgba(128, 128, 128, 0.7)'
                                                },
                                                handleSize: '100%',
                                                handleStyle: {
                                                    borderWidth: 0,
                                                    borderColor: 'transparent',
                                                    color: '#fff',
                                                    shadowBlur: 2,
                                                    shadowColor: 'rgba(0, 0, 0, 0.2)',
                                                    shadowOffsetX: 1,
                                                    shadowOffsetY: 1
                                                },
                                                dataBackground: {
                                                    lineStyle: {
                                                        color: 'rgba(128, 128, 128, 0.3)',
                                                        width: 1,
                                                        type: 'smooth'
                                                    },
                                                    areaStyle: {
                                                        color: 'rgba(128, 128, 128, 0.1)'
                                                    },
                                                }
                                            }
                                        ]
                                    };
                                    myCharts.setOption(options);
                                    // 监听节点点击事件
                                    myCharts.on('click', function (params) {
                                        var seriesIndex = params.seriesIndex;
                                        var dataIndex = params.dataIndex;
                                        myCharts.setOption({
                                            series: [
                                                {
                                                    seriesIndex: seriesIndex,
                                                    data: myCharts.getOption().series[seriesIndex].data.map(function (item, index) {
                                                        if (index === dataIndex) {
                                                            return {
                                                                id: item.id,
                                                                value: 0,
                                                                itemStyle: {
                                                                    color: '#d88a6b'
                                                                }
                                                            };
                                                        } else {
                                                            return {
                                                                id: item.id,
                                                                value: 0,
                                                                itemStyle: {
                                                                    color: bool_click ? '#79a063' : '#6e7074'
                                                                }
                                                            };
                                                        }
                                                    })
                                                }
                                            ]
                                        });
                                        var start = myCharts.getOption().dataZoom[0].startValue;
                                        var end = myCharts.getOption().dataZoom[0].endValue;
                                        if (dataIndex > (start + end) / 2) {
                                            var newStartValue = dataIndex;
                                            var newEndValue = dataIndex + 7;
                                            myCharts.setOption({
                                                dataZoom: [{
                                                    startValue: newStartValue,
                                                    endValue: newEndValue
                                                }]
                                            });
                                        }
                                        else if (dataIndex < (start + end) / 2) {
                                            myCharts.setOption({
                                                dataZoom: [{
                                                    startValue: dataIndex - 7,
                                                    endValue: dataIndex
                                                }]
                                            });
                                        }
                                    });
                                </script>


                                <!--人物关系与时间轴的交互-->
                                <script>
                                    let old_id = -1;
                                    var option_original = myCharts.getOption();
                                    var bool_click = true;
                                    var nodeId = [];
                                    for (var i = 0; i < characters.length; i++) {
                                        var sceneNumbers = characters[i].character_scene.match(/\d+/g);
                                        var sceneArray = sceneNumbers ? sceneNumbers.map(Number) : [];
                                        nodeId.push(sceneArray);
                                    }
                                    console.log(nodeId)
                                    myChart.on('click', function (params) {
                                        bool_click = true;
                                        myCharts.setOption(option_original);
                                        if (old_id !== -1) {
                                            if (old_id !== params.data.id) {
                                                old_id = params.data.id;
                                                let option = myCharts.getOption();
                                                let idList = nodeId[params.data.id];
                                                let newData = [];
                                                let newName = [];
                                                let newColor = '#79a063';
                                                option.series[0].data.forEach(function (item) {
                                                    if (idList.includes(item.id + 1)) {
                                                        newData.push(item);
                                                        newName.push(item.name);
                                                    }
                                                    option.series[0].data = newData;
                                                    option.xAxis[0].data = newName;
                                                    option.series[0].itemStyle.color = newColor;
                                                });
                                                myCharts.setOption(option);
                                            }
                                            else {
                                                bool_click = false;
                                                old_id = -1;
                                                return;
                                            }
                                        }
                                        else if (old_id === -1) {
                                            old_id = params.data.id;
                                            let option = myCharts.getOption();
                                            let idList = nodeId[params.data.id];
                                            let newData = [];
                                            let newName = [];
                                            let newColor = '#79a063';
                                            option.series[0].data.forEach(function (item) {
                                                if (idList.includes(item.id + 1)) {
                                                    newData.push(item);
                                                    newName.push(item.name);
                                                }
                                                option.series[0].data = newData;
                                                option.xAxis[0].data = newName;
                                                option.series[0].itemStyle.color = newColor;
                                            });
                                            myCharts.setOption(option);
                                        }
                                    });

                                </script>

                            </div>


                            <!--剧本-->
                            <div class="card"
                                style="margin-left:-25px;margin-top: -25px;width: 100%;background-color: rgba(0, 0, 0, 0);border: 1px solid rgba(255, 255, 255, 0.5);">
                                <div class="title3"
                                    style="width:100%;height: 2rem; display: flex; align-items: center;">
                                    <span
                                        style="display: inline-block; vertical-align: middle;padding-left: 3%;color: #eee;font-family: 'Orbitronio'">
                                        剧本</span>
                                </div>
                            </div>

                            <div class="card"
                                style="margin-left:-25px;margin-top: -30px;width: 100%;background-color: rgba(255, 255, 255, 0.05);border: 1px solid rgba(255, 255, 255, 0.5);">
                                <div id="script_content"
                                    style="overflow-y: scroll; width: 100%; max-height: 30rem; padding-top: 10px;">
                                            {% for scene in scenes %}
                                                    {{ scene.scene_content|safe }}
                                            {% endfor %}

                                    <!--滚动条-->
                                    <style>
                                        /* CSS 样式 */
                                        ::-webkit-scrollbar {
                                            width: 5px;
                                            /* 设置下拉条的宽度 */
                                            height: 8px;
                                            /* 设置下拉条的高度 */
                                        }

                                        ::-webkit-scrollbar-track {
                                            background-color: rgba(0, 0, 0, 0);
                                            /* 设置下拉条轨道的背景色 */
                                        }

                                        ::-webkit-scrollbar-thumb {
                                            background-color: #999;
                                            /* 设置下拉条滑块的背景色 */
                                            border-radius: 5px;
                                            /* 设置下拉条滑块的圆角 */
                                            border: 1px solid #eee;
                                            /* 设置下拉条滑块的边框 */
                                        }

                                        ::-webkit-scrollbar-thumb:hover {
                                            background-color: #555;
                                            /* 设置鼠标悬停时下拉条滑块的背景色 */
                                        }
                                    </style>
                                </div>
                                <script>
                                    // 监听节点点击事件
                                    myCharts.on('click', function (params) {
                                        var id_script = params.data.id + 1; // 获取对应节点的id
                                        console.log(id_script);
                                        var script_content = document.getElementById('script_content');
                                        var p = document.getElementById(id_script); // 找到对应的<p>元素
                                        if (p) {
                                            // 设置<p>元素的背景颜色高亮显示
                                            p.style.backgroundColor = 'rgb(152,245,255)';
                                            setTimeout(function () {
                                                p.style.backgroundColor = '';
                                            }, 1000); // 一秒后恢复背景颜色

                                            // 平滑滚动到对应的<p>元素
                                            var duration = 500; // 滚动时间
                                            var start = script_content.scrollTop; // 开始滚动位置
                                            var end = p.offsetTop - script_content.offsetTop; // 结束滚动位置
                                            var startTime = performance.now(); // 开始时间

                                            function scroll(timestamp) {
                                                var currentTime = performance.now() - startTime; // 当前时间
                                                var progress = Math.min(currentTime / duration, 1); // 滚动进度，不超过1
                                                var easeInOutQuad = function (t) { return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t }; // 缓动函数
                                                var scrollTop = easeInOutQuad(progress) * (end - start) + start; // 当前滚动位置
                                                script_content.scrollTop = scrollTop;
                                                if (progress < 1) {
                                                    window.requestAnimationFrame(scroll); // 继续滚动
                                                }
                                            }

                                            window.requestAnimationFrame(scroll); // 开始滚动
                                        }
                                    });
                                </script>
                            </div>


                        </div>



                        <div class="col-md-3">
                            <!--评分图-->
                            <div class="card"
                                style="margin-left:-50px;margin-top: -20px;width:140%;background-color: rgba(0, 0, 0, 0);border: 1px solid rgba(255, 255, 255, 0.5);">
                                <div class="title3"
                                    style="width:100%;height: 2rem; display: flex; align-items: center;">
                                    <span
                                        style="display: inline-block; vertical-align: middle;padding-left: 3%;color: #eee;">
                                        电影评分</span>
                                </div>
                            </div>
                            <div class="card"
                                style="margin-left:-50px;margin-top: -30px;width: 140%;background-color: rgba(255, 255, 255, 0.05);border: 1px solid rgba(255, 255, 255, 0.5);">
                                <!--不同网站评分图-->
                                <div id="rate_on_Webs" style="height: 40rem;width: 105%;"></div>
                                <script>
                                    // 定义数据
                                    const data_rate = [
                                        { name: 'Inception', value: 8.7, id: 1, year: 2.010 },
                                        { name: 'Batman Begins', value: 8.2, id: 2, year: 2.005 },
                                        { name: 'Dunkirk', value: 7.8, id: 3, year: 2.017 },
                                        { name: 'The Dark Knight Rises', value: 8.4, id: 4, year: 2.012 },
                                        { name: 'Memento', value: 8.4, id: 5, year: 2.000 },
                                        { name: 'The Prestige', value: 8.5, id: 6, year: 2.006 },
                                        { name: 'Following', value: 7.5, id: 7, year: 1.998 },
                                        { name: 'Star Wars: Episode II - Attack of the Clones', value: 6.5, id: 8, year: 2.002 },
                                        { name: 'Insomnia', value: 7.6, id: 9, year: 2.002 },
                                        { name: 'Tenet', value: 7.4, id: 10, year: 2.020 },
                                        { name: "The Time Traveler's Wife", value: 7.1, id: 11, year: 2.009 },
                                        { name: 'Terminator Salvation', value: 6.5, id: 12, year: 2.009 },
                                    ];
                                    const data_db = [
                                        { name: 'Inception', value: 9.4, id: 1, year: -2.010 },
                                        { name: 'Batman Begins', value: 8.6, id: 2, year: -2.005 },
                                        { name: 'Dunkirk', value: 8.4, id: 3, year: -2.017 },
                                        { name: 'The Dark Knight Rises', value: 8.8, id: 4, year: -2.012 },
                                        { name: 'Memento', value: 8.7, id: 5, year: -2.000 },
                                        { name: 'The Prestige', value: 8.9, id: 6, year: -2.006 },
                                        { name: 'Following', value: 8.9, id: 7, year: -1.998 },
                                        { name: 'Star Wars: Episode II - Attack of the Clones', value: 6.5, id: 8, year: -2.002 },
                                        { name: 'Insomnia', value: 7.5, id: 9, year: -2.002 },
                                        { name: 'Tenet', value: 7.6, id: 10, year: -2.020 },
                                        { name: "The Time Traveler's Wife", value: 7.7, id: 11, year: -2.009 },
                                        { name: 'Terminator Salvation', value: 6.7, id: 12, year: -2.009 },
                                    ];
                                    const data_rp = [
                                        { name: 'Inception', value: -8.7, id: 1, year: -2.010 },
                                        { name: 'Batman Begins', value: -8.4, id: 2, year: -2.005 },
                                        { name: 'Dunkirk', value: -8.0, id: 3, year: -2.017 },
                                        { name: 'The Dark Knight Rises', value: -8.7, id: 4, year: -2.012 },
                                        { name: 'Memento', value: -9.3, id: 5, year: -2.000 },
                                        { name: 'The Prestige', value: -7.6, id: 6, year: -2.006 },
                                        { name: 'Following', value: -7.8, id: 7, year: -1.998 },
                                        { name: 'Star Wars: Episode II - Attack of the Clones', value: -6.5, id: 8, year: -2.002 },
                                        { name: 'Insomnia', value: -9.2, id: 9, year: -2.002 },
                                        { name: 'Tenet', value: -7.0, id: 10, year: -2.020 },
                                        { name: "The Time Traveler's Wife", value: -3.8, id: 11, year: -2.009 },
                                        { name: 'Terminator Salvation', value: -3.3, id: 12, year: -2.009 },
                                    ];
                                    const data_Mdb = [
                                        { name: 'Inception', value: -8.7, id: 1, year: 2.010 },
                                        { name: 'Batman Begins', value: -8.3, id: 2, year: 2.005 },
                                        { name: 'Dunkirk', value: -8.3, id: 3, year: 2.017 },
                                        { name: 'The Dark Knight Rises', value: -8.8, id: 4, year: 2.012 },
                                        { name: 'Memento', value: -8.9, id: 5, year: 2.000 },
                                        { name: 'The Prestige', value: -8.6, id: 6, year: 2.006 },
                                        { name: 'Following', value: -8.5, id: 7, year: 1.998 },
                                        { name: 'Star Wars: Episode II - Attack of the Clones', value: -6.1, id: 8, year: 2.002 },
                                        { name: 'Insomnia', value: -6.3, id: 9, year: 2.002 },
                                        { name: 'Tenet', value: -7.4, id: 10, year: 2.020 },
                                        { name: "The Time Traveler's Wife", value: -7.9, id: 11, year: 2.009 },
                                        { name: 'Terminator Salvation', value: -6.0, id: 12, year: 2.009 },
                                    ];
                                    const data_Int = [
                                        { name: 'Interstellar', value: 8.6, id: 0, year: 2.014 },
                                        { name: 'Interstellar', value: 9.4, id: 0, year: -2.014 },
                                        { name: 'Interstellar', value: -7.2, id: 0, year: -2.014 },
                                        { name: 'Interstellar', value: -8.5, id: 0, year: 2.014 },
                                    ];
                                    const data_Inter = [
                                        { name: 'Interstellar', value: 8.6, id: 0, year: 2.014 },
                                        { name: 'Interstellar', value: 9.4, id: 0, year: -2.014 },
                                        { name: 'Interstellar', value: -7.2, id: 0, year: -2.014 },
                                        { name: 'Interstellar', value: -8.5, id: 0, year: 2.014 },
                                    ]
                                    const minYear = Math.min(...data_rate.map(item => item.year));
                                    const maxYear = Math.max(...data_rate.map(item => item.year));
                                    const normalizedData = data_rate.map(item => ({
                                        ...item,
                                        year: (item.year - minYear) / (maxYear - minYear),
                                    }));
                                    const mappedData = normalizedData.map(item => ({
                                        ...item,
                                        year: item.year === 0 ? 0.1 : item.year === 2.025 ? 2.024 : item.year * (2.025 - 0) + 0,
                                    }));
                                    data_Inter[0].year = (data_Inter[0].year - minYear) / (maxYear - minYear);
                                    data_Inter[0].year = data_Inter[0].year * (2.025 - 0) + 0;
                                    const minYear_db = Math.min(...data_db.map(item => item.year));
                                    const maxYear_db = Math.max(...data_db.map(item => item.year));
                                    const normalizedData_db = data_db.map(item => ({
                                        ...item,
                                        year: (item.year - minYear_db) / (maxYear_db - minYear_db),
                                    }));
                                    const mappedData_db = normalizedData_db.map(item => ({
                                        ...item,
                                        year: item.year === 0 ? -0.1 : item.year === -2.025 ? -2.024 : item.year * (-2.025 - 0),
                                    }));
                                    data_Inter[1].year = (data_Inter[1].year - minYear_db) / (maxYear_db - minYear_db);
                                    data_Inter[1].year = data_Inter[1].year * (-2.025 - 0);
                                    const minYear_rp = Math.min(...data_rp.map(item => item.year));
                                    const maxYear_rp = Math.max(...data_rp.map(item => item.year));
                                    const normalizedData_rp = data_rp.map(item => ({
                                        ...item,
                                        year: (item.year - minYear_rp) / (maxYear_rp - minYear_rp),
                                    }));
                                    const mappedData_rp = normalizedData_rp.map(item => ({
                                        ...item,
                                        year: item.year === 0 ? -0.1 : item.year === -2.025 ? -2.024 : item.year * (-2.025 - 0),
                                    }));
                                    data_Inter[2].year = (data_Inter[2].year - minYear_rp) / (maxYear_rp - minYear_rp);
                                    data_Inter[2].year = data_Inter[2].year * (-2.025 - 0);
                                    const minYear_Mdb = Math.min(...data_Mdb.map(item => item.year));
                                    const maxYear_Mdb = Math.max(...data_Mdb.map(item => item.year));
                                    const normalizedData_Mdb = data_Mdb.map(item => ({
                                        ...item,
                                        year: (item.year - minYear_Mdb) / (maxYear_Mdb - minYear_Mdb),
                                    }));
                                    const mappedData_Mdb = normalizedData_Mdb.map(item => ({
                                        ...item,
                                        year: item.year === 0 ? 0.1 : item.year === 2.025 ? 2.024 : item.year * (2.025 - 0) + 0,
                                    }));
                                    data_Inter[3].year = (data_Inter[3].year - minYear_Mdb) / (maxYear_Mdb - minYear_Mdb);
                                    data_Inter[3].year = data_Inter[3].year * (2.025 - 0) + 0;
                                    const modified_data_rate = (function (data) {
                                        for (let i = 0; i < data.length; i++) {
                                            if (data[i].year < 0) {
                                                data[i].year = Math.abs(data[i].year);
                                            }
                                        }
                                        return data;
                                    })(data_rate);

                                    const modified_data_db = (function (data) {
                                        for (let i = 0; i < data.length; i++) {
                                            if (data[i].year < 0) {
                                                data[i].year = Math.abs(data[i].year);
                                            }
                                        }
                                        return data;
                                    })(data_db);

                                    const modified_data_rp = (function (data) {
                                        for (let i = 0; i < data.length; i++) {
                                            if (data[i].year < 0) {
                                                data[i].year = Math.abs(data[i].year);
                                            }
                                        }
                                        return data;
                                    })(data_rp);

                                    const modified_data_Mdb = (function (data) {
                                        for (let i = 0; i < data.length; i++) {
                                            if (data[i].year < 0) {
                                                data[i].year = Math.abs(data[i].year);
                                            }
                                        }
                                        return data;
                                    })(data_Mdb);

                                    const modified_data_Int = (function (data) {
                                        for (let i = 0; i < data.length; i++) {
                                            if (data[i].year < 0) {
                                                data[i].year = Math.abs(data[i].year);
                                            }
                                        }
                                        return data;
                                    })(data_Int);



                                    var chartDom7 = document.getElementById('rate_on_Webs');
                                    var chart = echarts.init(chartDom7, 'dark');

                                    var option_rate = {
                                        title: {
                                            text: '',
                                        },
                                        tooltip: {
                                            formatter: function (params) {
                                                console.log(params.data)
                                                return ' ' + (Math.round(params.data[3] * 1000)).toString() + '年 :' + params.data[2];
                                            }
                                        },
                                        xAxis: {
                                            name: '年份',
                                            type: 'value',
                                            splitLine: {
                                                show: false
                                            },
                                            min: -2.023,
                                            max: 2.023,
                                            axisLine: {
                                                onZero: true,
                                                symbol: ['arrow', 'arrow'],
                                            },
                                            position: 'middle',
                                            axisTick: {
                                                show: false,
                                            },

                                            axisLabel: {
                                                show: false
                                            }
                                        },
                                        yAxis: {
                                            name: '评分',
                                            type: 'value',
                                            splitLine: {
                                                show: false
                                            },
                                            min: -10,
                                            max: 10,
                                            axisLine: {
                                                onZero: true,
                                                symbol: ['arrow', 'arrow'],
                                            },
                                            position: 'middle',
                                            axisTick: {
                                                show: false,
                                            },
                                            axisLabel: {
                                                show: false
                                            }
                                        },
                                        series: [
                                            {
                                                name: 'Interstellar',
                                                type: 'scatter',
                                                encode: {
                                                    tooltip: [0, 1, , 2, 3, 4]
                                                },
                                                data: data_Inter.map(function (item, index) {
                                                    return [item.year, item.value, item.name, data_Int[index].year];
                                                }),
                                            },
                                            {
                                                name: 'imDb',
                                                type: 'scatter',
                                                encode: {
                                                    tooltip: [0, 1, , 2, 3, 4]
                                                },
                                                data: mappedData.map(function (item, index) {
                                                    return [item.year, item.value, item.name, data_rate[index].year];
                                                }),
                                            },
                                            {
                                                name: 'DouBan',
                                                type: 'scatter',
                                                encode: { tooltip: [0, 1, , 2, 3, 4] },
                                                data: mappedData_db.map(function (item, index) {
                                                    return [item.year, item.value, item.name, data_db[index].year];
                                                }),

                                            },
                                            {
                                                name: 'Rotten Tomatoes',
                                                type: 'scatter',
                                                encode: { tooltip: [0, 1, , 2, 3, 4] },
                                                data: mappedData_rp.map(function (item, index) {
                                                    return [item.year, item.value, item.name, data_rp[index].year];
                                                }),

                                            },
                                            {
                                                name: 'MetaCritic',
                                                type: 'scatter',
                                                encode: { tooltip: [0, 1, , 2, 3, 4] },
                                                data: mappedData_Mdb.map(function (item, index) {
                                                    return [item.year, item.value, item.name, data_Mdb[index].year];
                                                }),

                                            },
                                        ],
                                        legend: {
                                            orient: 'vertical',
                                            left: 'left',
                                            top: 'middle'
                                        }
                                    };
                                    chart.setOption(option_rate);
                                </script>


                            </div>


                            <!-- 评论展示 -->
                            <div class="card"
                                style="margin-left:-50px;margin-top: -22px;width:140%;background-color: rgba(0, 0, 0, 0);border: 1px solid rgba(255, 255, 255, 0.5);">
                                <div class="title4"
                                    style="width:100%;height:2rem; display: flex; align-items: center;">
                                    <span
                                        style="display: inline-block; vertical-align: middle;padding-left: 3%;color: #eee;">
                                        专家评论</span>
                                </div>
                            </div>

                            <script>
                                function flipBox(counter) {
                                    var container = document.querySelector('.comment_container');
                                    var specificContainer = document.querySelector('.comment_container' + counter);
                                    specificContainer.classList.toggle('flipped');
                                }
                            </script>

                            <div class="card"
                                style="margin-left:-50px;margin-top: -30px;width: 140%;max-height:43.7rem;background-color:rgba(255, 255, 255, 0.05);border: 1px solid rgba(255, 255, 255, 0.5);">
                                <div class="comment_container_div"
                                    style="overflow-y: scroll;width: 105%; max-height: 43.7rem; ;padding-top: 10px;">

                                    {% for comment in comments %}
                                    <div class="comment_container comment_container{{ forloop.counter }}">
                                        <div class="comment_box" onclick="flipBox({{ forloop.counter }})">
                                            <div class="comment_front" style="background-color: rgba(0, 0, 0, 0); height: 200px;">
                                                <!-- 正面内容 -->
                                                <p class="comment_title">评论 {{ forloop.counter }}</p>
                                                <p class="comment_time">时间: {{ comment.comment_time }}</p>
                                                <p class="comment_author">作者: {{ comment.commentator }}</p>
                                            </div>
                                            <div class="comment_back" style="background-color: rgba(0, 0, 0, 0); height: 200px;">
                                                <!-- 背面内容 -->
                                                <p style="height: 200px;">{{ comment.comment_content|safe}}</p>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>


                            <style>
                                #character {
                                    background-color: #F8D7DA;
                                    border-radius: 4px;
                                }

                                #character:hover {
                                    background-color: #F4A1A1;
                                }

                                #movie {
                                    background-color: #E2E3E5;
                                    border-radius: 4px;
                                }

                                #movie:hover {
                                    background-color: #C6C8CC;
                                }

                                #director {
                                    background-color: #D1ECF1;
                                    border-radius: 4px;
                                }

                                #director:hover {
                                    background-color: #7BC8D1;
                                }

                                .comment_container {
                                    perspective: 1000px;
                                    position: relative;
                                }

                                /* 修改翻转 */
                                .comment_box {
                                    transform-style: preserve-3d;
                                    transition: transform 0.6s;
                                    cursor: pointer;
                                    margin: 10px;
                                    padding: 10px;
                                    position: relative;
                                    border: 1px solid rgba(0, 0, 0, 0.5);
                                    box-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
                                    /* background: linear-gradient(rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2)), url("your-background-image.jpg"); */
                                }

                                .comment_container.flipped .comment_box {
                                    transform: rotateY(180deg);
                                }

                                .comment_front,
                                .comment_back {
                                    backface-visibility: hidden;
                                    transform-style: preserve-3d;
                                }

                                .comment_front {
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    transform: rotateY(0deg);
                                }

                                .comment_back {
                                    background-color: #fef8ef;
                                    overflow-y: scroll;
                                    max-height: 200px;
                                    padding-top: 10px;
                                    margin-top: -200px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    transform: rotateY(180deg);
                                }

                                .comment_title,
                                .comment_time,
                                .comment_author {
                                    font-family: Arial, sans-serif;
                                    font-size: 14px;
                                    border-radius: 8px;
                                    padding: 10px;
                                    line-height: 1.4;
                                    height: 30%;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                }

                                .comment_title {
                                    background-color: #7c58c3;
                                    color: #fff;
                                    font-weight: bold;
                                    margin-right: 15px;
                                }

                                .comment_time {
                                    background-color: #43bcd4;
                                    color: #fff;
                                    font-weight: bold;
                                }

                                .comment_author {
                                    background-color: #e1437b;
                                    color: #fff;
                                    margin-left: 15px;
                                }
                            </style>




                        </div>

                    </div>


                </div>



            </div>

        </div>

    </div>
</body>

</html>